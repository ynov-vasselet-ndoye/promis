name: Docker Image CI for GHCR

on:
    release:
        types: [published]

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            - name: ğŸ›œ Checkout
              uses: actions/checkout@v4

            - name: ğŸ–¼ï¸ Build and push the frontend image
              if: ${{contains(github.event.release.tag_name, 'front')}}
              run: |
                docker login --username ${{ github.actor }} --password ${{ secrets.GITHUB_TOKEN }} ghcr.io
                docker build ./frontend --tag ghcr.io/${{ github.repository }}-front:latest
                docker push ghcr.io/${{ github.repository }}-front:latest

            - name: ğŸ—ƒï¸ Build and push the backend image
              if: ${{contains(github.event.release.tag_name, 'back')}}
              run: |
                docker login --username ${{ github.actor }} --password ${{ secrets.GITHUB_TOKEN }} ghcr.io
                docker build ./backend --tag ghcr.io/${{ github.repository }}-back:latest
                docker push ghcr.io/${{ github.repository }}-back:latest
